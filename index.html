<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Koulu Projekti</title>
    <meta name="description" content="Start of the web project" />
    <link rel="stylesheet" href="styles.css" />

    <!-- Map bare specifier 'geolib' to a browser ESM CDN -->
    <script type="importmap">
      {
        "imports": {
          "geolib": "https://esm.sh/geolib@3.3.4"
        }
      }
    </script>
    <script type="module" src="index.js"></script>
  </head>
  <body>
    <header>
      <nav>
        <h1>
          <a href="/index.html">
            <img class="logo" src="/public/logo.png" alt="Logo of the site" />
          </a>
        </h1>
        <ul class="nav-links">
          <li><a href="index.html">Kirjaudu</a></li>
          <li><a href="about.html">Tietoa</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <div id="cards-map-container">
        <aside id="cards-container">
          <!-- Example placeholder; you will render real cards here -->
          <!-- <div class="card"><h3>Ravintola Nimi</h3><p>Osoite / Kaupunki</p></div> -->
        </aside>

        <!-- RIGHT: Map with overlayed controls -->
        <section id="map-container">
          <div class="map-controls">
            <!-- Google Place Autocomplete -->
            <div class="autocomplete-container">
              <div class="autocomplete-container">
                <input
                  type="text"
                  id="autocomplete-input"
                  placeholder="Sijaintisi..."
                />
                <span id="help-icon" tabindex="0" aria-label="Kentän ohje"
                  >?</span
                >
                <span class="tooltip-text" role="tooltip"
                  >Kirjoita tähän sijaintisi <br />
                  nähdäksesi lähimmät ravintolat.</span
                >
              </div>
            </div>
            <div class="search-container">
              <input type="text" id="search-input" placeholder="Suodata..." />
              <span id="help-icon" tabindex="0" aria-label="Kentän ohje"
                >?</span
              >
              <span class="tooltip-text" role="tooltip"
                >Suodata hakemalla kaupungilla, yrityksellä tai koululla, <br />
                esimerkiksi: "Helsinki", "Metropolia" tai "Compass Group".
              </span>
            </div>
            <button id="search-button">Hae</button>
            <button id="clear-search-button">Tyhjennä</button>
          </div>

          <gmp-map
            center="65.0121,25.4651"
            zoom="5"
            map-id="DEMO_MAP_ID"
          ></gmp-map>
        </section>
      </div>
    </main>

    <footer>
      <p>&copy; <span id="year"></span></p>
    </footer>
    <script>
      window.initMap = async function () {
        try {
          const mod = await import("./components/map.js");
          if (mod && typeof mod.initMap === "function") {
            await mod.initMap();
          }
        } catch (e) {
          console.error("Failed to initialize map:", e);
        }
      };
    </script>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhkwx3nQO3JQ_wJ1JfdOFHWFZWxCjscug&libraries=places,marker&callback=initMap&v=beta"
      async
      defer
    ></script>
  </body>
</html>
