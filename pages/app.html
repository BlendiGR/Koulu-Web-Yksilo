<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Koulu Projekti</title>
    <meta name="description" content="Start of the web project" />
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/pages/home.css" />
    <link rel="stylesheet" href="../css/components/restaurantCards.css" />
    <link rel="stylesheet" href="../css/components/restaurantMenuPanel.css" />

    <script type="importmap">
      {
        "imports": {
          "geolib": "https://esm.sh/geolib@3.3.4"
        }
      }
    </script>
  </head>
  <body data-page="app-home">
    <header>
      <nav>
        <a href="./app.html">
          <img class="logo" src="../public/logo.png" alt="Logo of the site" />
        </a>
        <ul class="nav-links">
          <li>
            <img
              id="profile-avatar-nav"
              src="../public/avatar.jpg"
              alt="avatar"
            />
          </li>
          <li><a href="./profile.html">Profiili</a></li>
          <li id="logout-button"><a>Kirjaudu Ulos</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <div id="cards-map-container">
        <section>
          <div class="map-controls">
            <div class="autocomplete-container">
              <input
                type="text"
                id="autocomplete-input"
                placeholder="Sijaintisi..."
              />
            </div>

            <div class="city-select-container">
              <select id="city-filter" aria-label="Kaupunki">
                <option value="">Kaikki kaupungit</option>
                <option value="helsinki">Helsinki</option>
                <option value="espoo">Espoo</option>
                <option value="vantaa">Vantaa</option>
                <option value="tampere">Tampere</option>
                <option value="turku">Turku</option>
                <option value="oulu">Oulu</option>
                <option value="jyväskylä">Jyväskylä</option>
                <option value="kuopio">Kuopio</option>
                <option value="lahti">Lahti</option>
              </select>
            </div>

            <div class="search-container">
              <input type="text" id="search-input" placeholder="Suodata..." />
            </div>
          </div>

          <aside id="cards-panel">
            <div id="cards-container"></div>

            <div id="menu-panel" class="menu-panel">
              <button id="menu-close" class="menu-close">←</button>

              <div class="menu-header">
                <h2 id="mp-title"></h2>
                <button id="mp-fav-btn" class="fav-btn">★ Suosikki</button>
              </div>

              <p id="mp-address"></p>

              <div class="menu-tabs">
                <button id="mp-daily">Päivälista</button>
                <button id="mp-weekly">Viikkolista</button>
              </div>

              <span id="mp-restaurant-id" style="display: none"></span>

              <div id="mp-menu"></div>
            </div>
          </aside>
        </section>

        <section id="map-container">
          <gmp-map
            center="65.0121,25.4651"
            zoom="5"
            map-id="914bc1b32f958043a488e793"
          ></gmp-map>
        </section>
      </div>
    </main>

    <script>
      window.initMap = async function () {
        try {
          const mod = await import("../js/components/map.js");
          if (mod && typeof mod.initMap === "function") {
            await mod.initMap();
          }
        } catch (e) {
          console.error("Failed to initialize map:", e);
        }
      };
    </script>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhkwx3nQO3JQ_wJ1JfdOFHWFZWxCjscug&libraries=places,marker&callback=initMap&v=beta"
      async
      defer
    ></script>
    <script type="module" src="../js/pages/appHomePage.js"></script>
  </body>
</html>
